<!DOCTYPE html>
<html>
<head>
    <title>Favourite Restaurants</title>
    <link rel="stylesheet" href="../static/css/main.css">
    <link rel="stylesheet" href="restaurant.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer">
    
    <!-- Vue.js from CDN -->
    <script src="https://unpkg.com/vue@next"></script>

    <!-- Axios from CDN -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <link rel="stylesheet" href="ta_help.js">
    





    <!-- Your CSS and external dependencies here -->
    <style>
        /* Add a CSS class to change the color of the heart button container to red */
        .heart-button {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 1;
            cursor: pointer; /* Add a pointer cursor to indicate it's clickable */
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: white; /* Start with a red background */
        }

        /* Add a CSS class to change the heart button container to white when clicked */
        .heart-button.clicked {
            background-color: #ff8989;
        }

        /* Style for the black heart icon */
        .heart-button i {
            color: black;
        }
    </style>
</head>

<body>
    <!-- Your HTML content here, including the navigation bar -->

    <nav class="navbar navbar-expand-lg navbar-light" id="navigationBar">
        <a class="navbar-brand d-flex align-items-center" href="../templates/index.html">
            <img src="../static/images/icon.PNG" class="mr-2" id="Logo" alt="Logo">
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto nav">
                <li class="nav-item active mx-4">
                    <a class="nav-link" href="../templates/index.html" >Home</a>
                </li>
                <li class="nav-item active mx-4">
                    <a class="nav-link" href="../restaurants_filter/rest_filter.html" >Restaurant Filter</a>
                </li>
                <li class="nav-item active mx-4">
                    <a class="nav-link" href="../map/mapPointer2.html" >Restaurant Nearby</a>
                </li>
                <li class="nav-item active mx-4">
                    <a class="nav-link" href="../templates/contact.html">Contact Us</a>
                </li>
            </ul>
        </div>
        <div class="icons-container">
            <a href="../saved_fav_restaurant/fav_rest_ver2.html" class="bi bi-heart-fill" style="font-size: 20px;"></a>
            <a href="../Landing_page/landing_page.html" class="bi bi-box-arrow-right" style="font-size: 20px;"></a>
        </div>
    </nav>

    <div class="main-content">

        <div class ="col-md-8">
            <div class="px-3">
                <div id="card-container" class="row row-cols-1 row-cols-lg-2 row-cols-xl-3 g-5">
                    <!-- Cards will be displayed here -->
                </div>
            </div>
        </div>

    <div id="display_rest">
        <div class ="main-content py-4">
            <!-- Your content here -->
             
                   


                        <div id="card-container" class="row row-cols-1 row-cols-lg-2 row-cols-xl-3 g-5">
                            <div v-for="restaurant in likedRestaurants" :key="restaurant._id.$oid" class="col">
                                <div class="card">
                                    <img :src="restaurant.Image" class="card-img-top" alt="restaurant" @click="redirectToDetails(restaurant)">
                                 
                                    <!-- Add the heart button container and icon -->
                                    <div class="heart-button" @click="toggleFavorite(restaurant)" :class="{ clicked: restaurant.fav_restaurant }">
                                        <i class="fas fa-heart"></i>
                                    </div>


                                    <div class="card-body">
                                        <h4 class="card-title">{{ restaurant.Name }}</h4>
                                        <div class="location text-muted">{{ restaurant.Location }}</div>
                                        <h5 class="price-cat fw-bold">{{ restaurant.Price }}</h5>
                                        <!-- <div class="d-flex reviews-stars">
                                            <div v-for="star in restaurant.stars" :key="star" class="fas fa-star"></div>
                                        </div> -->

                                        <!-- <div class="d-flex reviews-stars">
                                            <div class="fas fa-star" v-for="star in calculateStars(restaurant.Ratings)" :key="star"></div>
                                          </div> -->
                                          <!-- <div class="d-flex reviews-stars">
                                            <div class="fas fa-star" v-for="star in calculateStars(restaurant.Ratings)" :key="star"></div>
                                          </div> -->
                                          <!-- <div class="d-flex reviews-stars">
                                            <div class="fas fa-star" v-for="star in calculateStars(restaurant.Ratings)" :key="star"></div>
                                          </div>
                                           -->
                                           <!-- <div class="d-flex reviews-stars">
                                            <div class="fas fa-star" v-for="star in 5" :key="star" :class="{ 'filled-star': star <= calculateStars(restaurant.Ratings).filled }"></div>
                                            <div class="fas fa-star" v-for="star in calculateStars(restaurant.Ratings).unfilled" :key="star"></div>
                                          </div> -->
                                          <!-- <div class="d-flex reviews-stars">
                                            <div class="fas fa-star" v-for="star in 5" :key="star" :class="{ 'filled-star': star <= calculateStars(restaurant.Ratings) }"></div>
                                          </div>
                                           -->
                                           <!-- <div class="d-flex reviews-stars">
                                            <div class="fas fa-star" v-for="star in calculateStars(restaurant.Ratings).unfilled" :key="star"></div>
                                            <div class="fas fa-star" v-for="star in calculateStars(restaurant.Ratings).filled" :key="star" :class="{ 'filled-star': star <= calculateStars(restaurant.Ratings).filled }"></div>
                                          </div> -->
                                          <!-- <div class="d-flex reviews-stars">
                                            <div class="fas fa-star" v-for="star in calculateStars(restaurant.Ratings).filled" :key="star" :class="{ 'filled-star': star <= calculateStars(restaurant.Ratings).filled && !calculateStars(restaurant.Ratings).isHalfStar }"></div>
                                            <div class="fas fa-star-half-alt" v-if="calculateStars(restaurant.Ratings).isHalfStar"></div>
                                            <div class="fas fa-star" v-for="star in calculateStars(restaurant.Ratings).unfilled" :key="star"></div>
                                          </div> -->
                                          <!-- <div class="d-flex reviews-stars">
                                            <div class="fas fa-star" v-for="star in calculateStars(restaurant.Ratings).filled" :key="star" :class="{ 'filled-star': star <= calculateStars(restaurant.Ratings).filled && !calculateStars(restaurant.Ratings).isHalfStar }"></div>
                                            <div class="fas fa-star-half-alt" v-if="calculateStars(restaurant.Ratings).isHalfStar"></div>
                                            <div class="far fa-star" v-for="star in calculateStars(restaurant.Ratings).unfilled" :key="star"></div>
                                          </div> -->
                                          <!-- <div class="d-flex reviews-stars">
                                            <div class="fas fa-star" v-for="star in calculateStars(restaurant.Ratings).filled" :key="star" :class="{ 'filled-star': true }"></div>
                                            <div class="fas fa-star-half-alt" v-if="calculateStars(restaurant.Ratings).hasHalfStar"></div>
                                            <div class="far fa-star" v-for="star in 5 - calculateStars(restaurant.Ratings).filled - (calculateStars(restaurant.Ratings).hasHalfStar ? 0.5 : 0)" :key="star"></div>
                                          </div> -->

                                          <!-- <div class="d-flex reviews-stars">
                                            <div class="fas fa-star" v-for="star in calculateStars(restaurant.Ratings).filled" :key="star" :class="{ 'filled-star': true }"></div>
                                            <div class="fas fa-star-half-alt" v-if="calculateStars(restaurant.Ratings).hasHalfStar"></div>
                                            <div class="far fa-star" v-for="star in calculateStars(restaurant.Ratings).unfilled" :key="star"></div>
                                          </div> -->
                                          <!-- <div class="d-flex reviews-stars">
                                            <div class="fas fa-star" v-for="star in 5" :key="star" :class="{ 'filled-star': star <= calculateStars(restaurant.Ratings).filled && !calculateStars(restaurant.Ratings).hasHalfStar }"></div>
                                            <div class="fas fa-star-half-alt" v-if="calculateStars(restaurant.Ratings).hasHalfStar"></div>
                                            <div class="far fa-star" v-for="star in 5 - calculateStars(restaurant.Ratings).filled - (calculateStars(restaurant.Ratings).hasHalfStar ? 0.5 : 0)" :key="star"></div>
                                          </div> -->
                                          <!-- <div class="d-flex reviews-stars">
                                            <span class="fas fa-star" v-for="star in fullStars" :key="star"></span>
                                            <span class="fas fa-star-half-alt" v-if="halfStar"></span>
                                            <span class="far fa-star" v-for="star in emptyStars" :key="star"></span>
                                          </div>
                                           -->
                                           <!-- <div class="d-flex reviews-stars">
                                            <div class="fas fa-star" v-for="star in 5" :key="star" :class="{ 'filled-star': star <= calculateStars(restaurant.Ratings).filled && !calculateStars(restaurant.Ratings).hasHalfStar }"></div>
                                            <div class="fas fa-star-half-alt" v-if="calculateStars(restaurant.Ratings).hasHalfStar"></div>
                                            <div class="far fa-star" v-for="star in 5 - calculateStars(restaurant.Ratings).filled - (calculateStars(restaurant.Ratings).hasHalfStar ? 0.5 : 0)" :key="star"></div>
                                          </div> -->
                                          <!-- <div class="d-flex reviews-stars">
                                            <div class="fas fa-star" v-for="star in 5" :key="star" :class="{ 'filled-star': star <= calculateStars(restaurant.Ratings) }"></div>
                                        </div>
                                           -->
                                           <!-- <div class="d-flex reviews-stars">
                                            <div class="fas fa-star" v-for="star in calculateStars(ratings).filled" :key="star"></div>
                                            <div class="fas fa-star-half-alt" v-if="calculateStars(ratings).hasHalfStar"></div>
                                            <div class="far fa-star" v-for="star in calculateStars(ratings).unfilled" :key="star"></div>
                                          </div> -->
                                          <!-- <div class="star-ratings"> -->
                                            <!-- <div class="star" v-for="star in filledStars(restaurant.Ratings)"></div>
                                            <div class="star" v-for="star in unfilledStars(restaurant.Ratings)"></div>
                                          </div>
                                           -->
                                           <!-- <div class="d-flex reviews-stars">
                                             Calculate and display filled stars 
                                            <div class="fas fa-star" v-for="star in filledStars(restaurant.Ratings)" :key="star"></div>
                                            Display half star if applicable 
                                            <div class="fas fa-star-half-alt" v-if="hasHalfStar(restaurant.Ratings)"></div>
                                            Calculate and display unfilled stars 
                                            <div class="far fa-star" v-for="star in unfilledStars(restaurant.Ratings)" :key="star"></div>
                                          </div>-->
                                           

                                           <div class="d-flex reviews-stars">
                                            <div class="fas fa-star" v-for="star in filledStars(restaurant.Ratings).filled" :key="star"></div>
                                            <div class="fas fa-star-half-alt" v-if="filledStars(restaurant.Ratings).hasHalfStar"></div>
                                            <div class="far fa-star" v-for="star in filledStars(restaurant.Ratings).unfilled" :key="star"></div>
                                          </div>
                                          
                                          
                                          
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div> 

                           
<!-- 
                                    <div class="card-body">
                                        <h4 class="card-title">{{ restaurant.Name }}</h4>
                                        <div class="cuisine text-muted">{{ restaurant.Location }}</div>
                                        <h5 class="price-cat fw-bold">{{ restaurant.Price }}</h5> -->
                                         <!-- <div class="d-flex reviews-stars">
                                            <div v-for="star in restaurant.stars" :key="star" class="fas fa-star">
                                                <span v-html="generateStarRating(restaurant.Ratings)"></span>
                                            </div>
                                        </div>  -->

<!-- 
                                        <div v-if="reviewIs5(restaurant.ratings)"></div>
                                        {{ stars_5 }}
                                        </div>
     -->
<!-- 



                                        <div class="d-flex reviews-stars">
                                            <span v-html="generateStarRating(restaurant.Ratings)"></span>
                                        </div>  -->


                                        <!-- //stars that is linked to fav_rest2 vue.html

const stars_5 = `<div class="fas fa-star"></div>
<div class="fas fa-star"></div>
<div class="fas fa-star"></div>
<div class="fas fa-star"></div>
<div class="fas fa-star"></div>`
const stars_45 = `<div class="fas fa-star"></div>
<div class="fas fa-star"></div>
<div class="fas fa-star"></div>
<div class="fas fa-star"></div>
<div class="fas fa-star-half"></div>`



                                        -->

               

<!-- <script>
        Vue.createApp(
            data() {
                return {
                    likedRestaurants: []
                    

                }
            },
            created() {
                // Your existing data retrieval code
                axios.get('http://127.0.0.1:5000/api/restaurants')
                    .then(response => {
                        this.likedRestaurants = response.data.filter(restaurant => restaurant.fav_restaurant === true);

            //             //change it to false when u unclick
            //         })
            //         .catch(error => {
            //             console.error('Error fetching data:', error); -->
<!-- 
            //         });
            // },
            // methods: {
            //   toggleFavorite(restaurant) {
             
            //         restaurant.fav_restaurant = !restaurant.fav_restaurant;
                    
            //         rest_id = restaurant["_id"]["$oid"]
            //         axios.post('http://localhost:5000/api/restaurant/' + rest_id, {
            //             'fav_restaurant': false
            //         }).then(
            //             response => {
            //                 console.log(response.data)
            //             }
            //         ).catch(
            //             error => {
            //                 console.log(error)
            //             })
            //  },
            
            //     redirectToDetails(restaurant) {
            //     //    location.href = '../restaurant_cards/card_details.html';

            //        rest_id = restaurant["_id"]["$oid"]
            //       location.href = `../restaurant_cards/card_details_v2.html?id=${rest_id}`;

            //     }
            // }).mount("#display_rest")
                // generateStarRating(restaurant.Ratings) {
                // // Define star symbols
                // const checkedStar = '★';
                // const halfStar = '½';
                // const uncheckedStar = '☆';

                // // Calculate the number of full stars and whether to display a half star
                // const fullStars = Math.floor(rating);
                // const hasHalfStar = rating % 1 !== 0;

                // let starRating = '';

                // // Add full stars
                // for (let i = 0; i < fullStars; i++) {
                //     starRating += checkedStar;
                // }

                // // Add half star if needed
                // if (hasHalfStar) {
                //     starRating += halfStar;
                // }

                // // Add remaining empty stars
                // const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
                // for (let i = 0; i < emptyStars; i++) {
                //     starRating += uncheckedStar;
                // }

                // return starRating;
                // }

            //     reviewIs5(restaurant.ratings){
            //         if (ratings <0.5){
            //             display(stars_0)
            //         }
            //         else if (ratings <1){
            //             display(stars_05)
            //         }

            //         reviewIs5(rating){
            //             if ratings == 5{
            //                 return True
            //             }
            //             else {
            //                 return False
            //             }
            //         }

            //     }
            // }

                 -->
        <!-- //     return starRating;
        // },
 
            
        //             rest_id = restaurant["_id"]["$oid"]
        //             axios.post('http://localhost:5000/api/restaurant/' + rest_id, {
        //     'fav__restaurants': false
        // }).then(
        //     response => {
        //         console.log(response.data)
        //     }
        // ).catch(
        //     error => {
        //         console.log(error)
        //     })

        //         }
        //     }
        


//         cal.component("stars-display",{
//             props:['']
//             const stars_45 = `<div class="fas fa-star"></div>
// <div class="fas fa-star"></div>
// <div class="fas fa-star"></div>
// <div class="fas fa-star"></div>
// <div class="fas fa-star-half"></div>`


 -->




    
        
        
        
        
        
        
        
      

<script>
    Vue.createApp({
        data() {
            return {
                likedRestaurants: [],
                ratings: 0,
                
                

            }
        },
        created() {
            // Your existing data retrieval code
            axios.get('http://127.0.0.1:5000/api/restaurants')
                .then(response => {
                    this.likedRestaurants = response.data.filter(restaurant => restaurant.fav_restaurant === true);
                    
                    //change it to false when u unclick
                })
                .catch(error => {
                    console.error('Error fetching data:', error);

                });
        },
      
        
        methods: {
          toggleFavorite(restaurant) {
         
                restaurant.fav_restaurant = !restaurant.fav_restaurant;
                
                rest_id = restaurant["_id"]["$oid"]
                axios.post('http://localhost:5000/api/restaurant/' + rest_id, {
                'fav_restaurant': false
            }).then(
                response => {
                    console.log(response.data)
                }
            ).catch(
                error => {
                    console.log(error)
                })

    //         }
    //     }
            },
            redirectToDetails(restaurant) {
                // location.href = '../restaurant_cards/card_details.html';
                
                rest_id = restaurant["_id"]["$oid"]
                  location.href = `../restaurant_cards/card_details_v2.html?id=${rest_id}`;
            },
            // calculateStars(ratings) {
            // // Convert ratings to stars (assuming ratings are out of 5)
            // const maxRating = 5;
            // const filledStars = Math.round((ratings / maxRating) * maxRating);
            // return Array(filledStars).fill(0);
    //         // }
    //         filledStars(ratings) {
    //     const maxRating = 5;
    //     const filledStars = Math.floor(ratings);
    //     return Array(filledStars).fill(0);
    //     },
    //     hasHalfStar(ratings) {
    //     return ratings % 1 === 0.5;
    //     },
    //     unfilledStars(ratings) {
    //     const maxStars = 5;
    //     const filledStars = Math.floor(ratings);
    //     const halfStar = this.hasHalfStar(ratings) ? 1 : 0;
    //     const unfilledStars = maxStars - filledStars - halfStar;
    //     return Array(unfilledStars).fill(0);
    //     },
    // },
    filledStars(ratings) {
  const roundedRatings = Math.round(ratings);
  const maxRating = 5;
  
  if (roundedRatings === Math.floor(ratings) + 0.5) {
    // If the rounded ratings are exactly x.5, show x filled stars and 0.5 half star
    return {
      filled: Math.floor(ratings),
      hasHalfStar: true,
      unfilled: maxRating - Math.ceil(ratings),
    };
  } else {
    // For other cases, show rounded ratings as filled stars and remaining stars as unfilled
    return {
      filled: Math.round(ratings),
      hasHalfStar: false,
      unfilled: maxRating - Math.round(ratings),
    };
  }
}
}
   




          






//   // Check if there is a half-star (rating ends with .5)
//   const hasHalfStar = ratings % 1 === 0.5;

//   return { filled: filledStars, hasHalfStar };
// // }
//                         calculateStars(ratings) {
//                         // Calculate the number of filled stars based on integer part of the rating
//                         const filledStars = Math.floor(ratings);

//                         // Calculate the number of unfilled stars
//                         const unfilledStars = 5 - filledStars;

//                         // Determine if there is a half-star (rating ends with .5)
//                         const hasHalfStar = ratings % 1 === 0.5;

//                         return { filled: filledStars, unfilled: unfilledStars, hasHalfStar };
//                         }

                            // calculateStars(ratings) {
                            // // Calculate the number of filled stars based on integer part of the rating
                            // const filledStars = Math.floor(ratings);
                            
                            // // Determine if there is a half-star (rating ends with .5)
                            // const hasHalfStar = ratings % 1 === 0.5;
                            
                            // // Ensure there are always 5 stars in total
                            // const totalStars = Math.min(5, filledStars + (hasHalfStar ? 0.5 : 0));
                            
                            // return { filled: totalStars, hasHalfStar };
                            // }


//                             calculateStars(ratings) {
//   // Calculate the number of filled stars based on integer part of the rating
//   const filledStars = Math.floor(ratings);
  
//   // Determine if there is a half-star (rating ends with .5)
//   const hasHalfStar = ratings % 1 === 0.5;
  
//   // Ensure there are always 5 stars in total
//   const totalStars = Math.min(5, filledStars + (hasHalfStar ? 0.5 : 0));
  
//   return { filled: totalStars, hasHalfStar };
// }
// calculateStars(ratings) {
//                     // Round the ratings to the nearest whole number and clamp to a range of 0 to 5
//                     const roundedRatings = Math.min(Math.max(Math.round(ratings), 0), 5);
//                     return roundedRatings;
// //                 }
// calculateStars(ratings) {
//     // Round the ratings to the nearest whole number
//     const roundedRatings = Math.round(ratings);
    
//     // Check if there's a half-star
//     const hasHalfStar = (ratings - roundedRatings) === 0.5;

//     // Calculate the number of filled stars (rounded down)
//     const filledStars = Math.floor(roundedRatings);
    
//     // Calculate the number of unfilled stars
//     const unfilledStars = 5 - filledStars - (hasHalfStar ? 0.5 : 0);

//     return { filled: filledStars, hasHalfStar, unfilled: unfilledStars };
// }
// calculateStars(ratings) {
//           // Calculate the number of filled stars (rounded down)
//           const filledStars = Math.floor(ratings);

//           // Check if there's a half-star
//           const hasHalfStar = (ratings - filledStars) === 0.5;

//           // Calculate the number of unfilled stars
//           const maxStars = 5;
//           const unfilledStars = maxStars - filledStars - (hasHalfStar ? 0.5 : 0);

//           return { filledStars, hasHalfStar, unfilledStars };
//         }
// filledStars(ratings) {
//       // Calculate the number of filled stars (rounded down)
//       const filledStars = Math.floor(ratings);

//       return new Array(filledStars);
//     },
//     unfilledStars(ratings) {
//       const maxStars = 5;
//       // Calculate the number of unfilled stars
//       const unfilledStars = maxStars - Math.ceil(ratings);

//       return new Array(unfilledStars);
//     },








        
    //             rest_id = restaurant["_id"]["$oid"]
    //             axios.post('http://localhost:5000/api/restaurant/' + rest_id, {
    //     'fav__restaurants': false
    // }).then(
    //     response => {
    //         console.log(response.data)
    //     }
    // ).catch(
    //     error => {
    //         console.log(error)
    //     })

    //         }
    //     }
    }).mount("#display_rest");
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
</body>
</html>







